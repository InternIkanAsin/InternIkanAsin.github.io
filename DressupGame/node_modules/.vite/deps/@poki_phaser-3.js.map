{
  "version": 3,
  "sources": ["../../@poki/phaser-3/dist/phaser-poki.js"],
  "sourcesContent": ["var $gvRdH$phaser = require(\"phaser\");\n\nfunction $parcel$exportWildcard(dest, source) {\n  Object.keys(source).forEach(function(key) {\n    if (key === 'default' || key === '__esModule' || dest.hasOwnProperty(key)) {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function get() {\n        return source[key];\n      }\n    });\n  });\n\n  return dest;\n}\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\nvar $66a613ab66341f23$exports = {};\n\n$parcel$export($66a613ab66341f23$exports, \"EVENT_INITIALIZED\", () => $66a613ab66341f23$export$7d17243235f36b85);\n$parcel$export($66a613ab66341f23$exports, \"PokiPlugin\", () => $66a613ab66341f23$export$176a0ece5b97d00d);\n\nconst $66a613ab66341f23$export$7d17243235f36b85 = \"poki:initialized\";\nclass $66a613ab66341f23$export$176a0ece5b97d00d extends (0, $gvRdH$phaser.Plugins).BasePlugin {\n    init({ loadingSceneKey: loadingSceneKey , gameplaySceneKey: gameplaySceneKey , autoCommercialBreak: autoCommercialBreak  }) {\n        this._loadingSceneKey = loadingSceneKey;\n        this._gameplaySceneKey = gameplaySceneKey;\n        this._autoCommercialBreak = autoCommercialBreak;\n        this._scriptLoaded = false;\n        this._initializeHooks = [];\n        this._queue = [];\n        this.initialized = false;\n        this.hasAdblock = true;\n        const script = document.createElement(\"script\");\n        script.setAttribute(\"type\", \"text/javascript\");\n        script.setAttribute(\"src\", \"https://game-cdn.poki.com/scripts/v2/poki-sdk.js\");\n        script.addEventListener(\"load\", ()=>{\n            this.sdk = window.PokiSDK;\n            this._scriptLoaded = true;\n            this._queue.forEach((f)=>f());\n            this.sdk.init().then(()=>{\n                this.initialized = true;\n                this.hasAdblock = false;\n                this.game.events.emit($66a613ab66341f23$export$7d17243235f36b85, this);\n                this._initializeHooks.forEach((f)=>f(this));\n                this._initializeHooks = undefined;\n            }).catch((err)=>{\n                console.error(\"PokiSDK failed\", err);\n                this.initialized = true;\n                this.hasAdblock = true;\n                this.game.events.emit($66a613ab66341f23$export$7d17243235f36b85, this);\n                this._initializeHooks.forEach((f)=>f(this));\n                this._initializeHooks = undefined;\n            });\n        });\n        script.addEventListener(\"error\", (e)=>{\n            console.error(\"failed to load PokiSDK\", e);\n        });\n        document.head.appendChild(script);\n        this._currentScenes = [];\n    }\n    runWhenInitialized(callback) {\n        if (this.initialized) callback(this) // eslint-disable-line node/no-callback-literal\n        ;\n        else this._initializeHooks.push(callback);\n    }\n    // Called by Phaser, do not use\n    start() {\n        this.game.events.on(\"step\", this._update, this);\n    }\n    // Called by Phaser, do not use\n    stop() {\n        this.game.events.off(\"step\", this._update);\n    }\n    _update() {\n        // Detect if new actives scenes are added or removed:\n        const names = this.game.scene.getScenes(true).map((s)=>s.constructor.name);\n        this._currentScenes.forEach((name)=>{\n            if (names.indexOf(name) === -1) {\n                this._currentScenes.splice(this._currentScenes.indexOf(name), 1);\n                if (name === this._loadingSceneKey) this.gameLoadingFinished();\n                if (name === this._gameplaySceneKey) this.gameplayStop();\n            }\n        });\n        names.forEach((name)=>{\n            if (this._currentScenes.indexOf(name) === -1) {\n                this._currentScenes.push(name);\n                if (name === this._loadingSceneKey) this.gameLoadingStart();\n                if (name === this._gameplaySceneKey) {\n                    if (this._scriptLoaded && this._autoCommercialBreak && !this.hasAdblock) this.commercialBreak().then(()=>{\n                        this.gameplayStart();\n                    });\n                    else this.gameplayStart();\n                }\n            }\n        });\n    }\n    // Manually call the gameLoadedStart event in the PokiSDK, this is done\n    // automatically if you've set the loadingSceneKey in the plugin data.\n    gameLoadingStart() {\n        if (this._scriptLoaded) this.sdk.gameLoadingStart();\n        else this._queue.push(()=>{\n            this.sdk.gameLoadingStart();\n        });\n    }\n    // Manually call the gameLoadingFinished event in the PokiSDK, this is done\n    // automatically if you've set the loadingSceneKey in the plugin data.\n    gameLoadingFinished() {\n        if (this._scriptLoaded) this.sdk.gameLoadingFinished();\n        else this._queue.push(()=>{\n            this.sdk.gameLoadingFinished();\n        });\n    }\n    // Manually call the gameplayStart event in the PokiSDK, this is done\n    // automatically if you've set the gameplaySceneKey in the plugin data.\n    gameplayStart() {\n        if (this._scriptLoaded) this.sdk.gameplayStart();\n        else this._queue.push(()=>{\n            this.sdk.gameplayStart();\n        });\n    }\n    // Manually call the gameplayStop event in the PokiSDK, this is done\n    // automatically if you've set the gameplaySceneKey in the plugin data.\n    gameplayStop() {\n        if (this._scriptLoaded) this.sdk.gameplayStop();\n        else this._queue.push(()=>{\n            this.sdk.gameplayStop();\n        });\n    }\n    // Manually request a commercialBreak via the PokiSDK, this is done\n    // automatically if you've set autoCommercialBreak to true in the plugin data\n    // and the configured gameplayScene started/resumed.\n    commercialBreak() {\n        return this._break(\"commercial\");\n    }\n    // Trigger a rewardedBreak via the PokiSDK when called.\n    rewardedBreak() {\n        return this._break(\"rewarded\");\n    }\n    _break(type) {\n        if (type !== \"commercial\" && type !== \"rewarded\") throw new Error('type must be \"commercial\" or \"rewarded\"');\n        if (this.initialized && !this.hasAdblock) return new Promise((resolve)=>{\n            const wasKeyboardEnbaled = this.game.input.keyboard.enabled;\n            this.game.input.keyboard.enabled = false;\n            const wasMuted = this.game.sound.mute;\n            this.game.sound.mute = true;\n            this.sdk[`${type}Break`]().then((success)=>{\n                if (wasKeyboardEnbaled) this.game.input.keyboard.enabled = true;\n                if (!wasMuted) this.game.sound.mute = false;\n                resolve(success);\n            });\n        });\n        return Promise.resolve(false);\n    }\n}\n\n\n$parcel$exportWildcard(module.exports, $66a613ab66341f23$exports);\n\n\n//# sourceMappingURL=phaser-poki.js.map\n"],
  "mappings": "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",
  "names": []
}
